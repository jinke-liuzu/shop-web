<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <div th:include="index :: header" ></div>
</head>
<body>
<table class="table" id="myTable"></table>
</body>
<script>
    $(function(){
        initcommodityTable();
    })
    //查询
    function initcommodityTable(){
        $("#myTable").bootstrapTable({
            url:'/ldl/queryche',
            toolbar:'#toolbar',
            method: 'post',
            contentType: 'application/x-www-form-urlencoded',//posti求按照表单方式
            pagination:true,//是否展示分页
            showRefresh:true,
            pageNamber:1,//起始页
            pageSize:5,//每页条数
            pageList:[2,5,10,20],
            sidePagination:'server',//分页方式：client客户端分页，server服务端分页（*
            striped:true,//是否显示斑马线
            queryParams:function(){
                return {
                    page:this.pageNumber,
                    rows:this.pageSize
                };
            },
            columns:[
                {field:"abc",checkbox:true},
                {field:"number",title:"编号",width:100},
                {field:"name",title:"名称",width:150,formatter:function(value,row,index){
                        if(row.money==null || row.money=='' ||row.money=="-"){
                            return "<font color='#ff0000'>"+value+"<font>";
                        }else{
                            return "<font color='#00ff00'>"+value+"<font>";
                        }
                    }},
                {field:"datetime",title:"创建时间",width:150},
                {field:"state",title:"是否上架",width:50,formatter:function(value,row,index){
                        if(row.state==1){
                            return "<font color='#00ff00'size=\"+5\">√<font>";
                        }else{
                            return "<font color='#ff0000'size=\"+5\">×<font>";
                        }

                    }},
                {field:"goodsname",title:"商品分类",width:150},
                {field:"money",title:"商品价格",width:50},
                {field:"url",title:"路径",width:150},
                {field:"url",title:"操作",width:150,formatter:function(value,row,index){
                        var str = "<a href='javascript:updateOne("+row.id+")'>&nbsp;删除&nbsp;</a>|<a href='javascript:editbook()'>&nbsp;&nbsp;去结算&nbsp;&nbsp;</a>";

                        return str;
                    }}
            ]
        })
    }
    //加入购物车
    function updateOne(id) {
        $.ajax({
            url:'/ldl/updateOne',
            type:'post',
            data:{id:id},
            success:function(data){
                if(data){
                    history.go(0);
                }else{
                    bootbox.alert({
                        size:'small',
                        title:'提示',
                        message:'删除失败',
                    })
                }
            }

        })
    }
    function editbook() {
        //新增
            bootbox.dialog({
                title:'扫一扫',
                message: createAddContent("/ldl/toerweima"),
                closeButton: true,//是否显示关闭按钮
                buttons : {
                    "success" : {
                        "label" : "<i class='icon-ok'></i> 确定",
                        "className" : "btn-sm btn-success",
                        "callback" : function() {

                        }
                    },
                    "cancel" : {
                        "label" : "<i class='icon-info'></i> 取消",
                        "className" : "btn-sm btn-danger",
                        "callback" : function() {

                        }
                    }
                }

            });




    }
    var res;
    function createAddContent(url){
        $.ajax({
            url:url,
            async:false,//同步
            success:function(data){
                res = data;
            }
        });
        return res;
    }
</script>
</html>